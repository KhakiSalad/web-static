(()=>{var e,t={43766:(e,t,n)=>{"use strict";var a=n(93379),r=n.n(a),o=n(7795),i=n.n(o),l=n(90569),s=n.n(l),d=n(3565),c=n.n(d),u=n(19216),g=n.n(u),h=n(44589),v=n.n(h),f=n(71253),m={};m.styleTagTransform=v(),m.setAttributes=c(),m.insert=s().bind(null,"head"),m.domAPI=i(),m.insertStyleElement=g();r()(f.Z,m);f.Z&&f.Z.locals&&f.Z.locals;n(47244);var p=n(78246),y=n(92850),x=n(98599);function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#svg-container";b(this,e),C(this,"svg",void 0),this.dataStorage=window.sessionStorage,this.svgHeight=-1,this.svgWidth=-1,this.svgPadding=a,this.gridsize=t,this.val_col=n,this.container=r,this.posxCol=this.dataStorage.getItem("posxCol"),this.posyCol=this.dataStorage.getItem("posyCol"),this.sizexCol=this.dataStorage.getItem("sizexCol"),this.sizeyCol=this.dataStorage.getItem("sizeyCol"),this.svg=p.Ys(this.container).append("svg").attr("width","100%").attr("height","100%"),this.plotData()}var t,n,a;return t=e,n=[{key:"plotData",value:function(){var e=this;if(Object.keys(this.dataStorage).includes("data")){console.log("loading data from session storage");var t=JSON.parse(this.dataStorage.getItem("data"));Object.setPrototypeOf(t,y.DataFrame.prototype),t=t.$data.map((function(e){return Object.fromEntries(e.map((function(e,n){return[t.$columns[n],e]})))})),this.posxCol=this.dataStorage.getItem("posxCol"),this.posyCol=this.dataStorage.getItem("posyCol"),this.sizexCol=this.dataStorage.getItem("sizexCol"),this.sizeyCol=this.dataStorage.getItem("sizeyCol");var n=JSON.parse(this.dataStorage.getItem("max_values")),a=n.maxX,r=n.maxY,o=n.minX,i=n.minY;this.svgWidth=document.getElementById("svg-container").offsetWidth,this.scaleX=p.BYU().domain([0,a]).range([this.svgPadding,this.svgWidth-this.svgPadding]),this.svgHeight=this.svgWidth*((r-i)/(a-o)),document.getElementById("svg-container").style.height=this.svgHeight+"px",this.scaleY=p.BYU().domain([0,r]).range([this.svgHeight-this.svgPadding,this.svgPadding]);var l=t.map((function(t){return t[e.val_col.value]})).filter((function(e){return!isNaN(e)})),s=l.reduce((function(e,t){return Math.min(e,t)}),1/0),d=l.reduce((function(e,t){return Math.max(e,t)}),-1/0);this.scaleQualityValue=p.cJy([s,d],p.sN9),this.drawComponents(t),this.drawGrid(),this.drawAxesAndLegend();var c=document.getElementsByClassName("component").length;console.debug("drew %d components (of %d possible)",c,t.length)}}},{key:"drawComponents",value:function(e){var t=this;console.log("drawing components for data: %O",e);var n=this.svg,a=this.scaleX,r=this.scaleY,o=this.scaleQualityValue;n.selectAll(".component").remove(),n.selectAll(".component").data(e).enter().append("rect").classed("component",!0).attr("width",(function(e){var n=a(e[t.posxCol]-e[t.sizexCol]/2);return a(Number(e[t.posxCol])+e[t.sizexCol]/2)-n})).attr("height",(function(e){return r(e[t.posyCol]-e[t.sizeyCol]/2)-r(e[t.posyCol]+e[t.sizeyCol]/2)})).attr("x",(function(e){return a(e[t.posxCol]-e[t.sizexCol]/2)})).attr("y",(function(e){return r(e[t.posyCol]-e[t.sizeyCol]/2)})).attr("value",(function(e){return e[t.val_col.value]})).attr("id",(function(e){return e["PAD ID"]})).style("fill",(function(n){return o(t.aggregateQualityInGrid(e,n[t.posxCol],n[t.posyCol]))})).append("title").html((function(e){return e[t.val_col.value]})),n.selectAll(".component").data(e).exit().remove()}},{key:"drawGrid",value:function(){var e=this,t=JSON.parse(this.dataStorage.getItem("max_values")),n=t.maxX,a=t.maxY,r=(t.minX,t.minY,this.svg),o=Array.from({length:n/this.gridsize.value},(function(t,n){return(n+1)*e.gridsize.value})),i=Array.from({length:a/this.gridsize.value},(function(t,n){return(n+1)*e.gridsize.value}));r.selectAll(".vert_line").data(o).enter().append("line").classed("vert_line",!0),r.selectAll(".vert_line").data(o).attr("x1",(function(t){return e.scaleX(t)})).attr("x2",(function(t){return e.scaleX(t)})).attr("y1",this.svgPadding).attr("y2",this.svgHeight-this.svgPadding).style("stroke-width",1).style("stroke","gray").style("fill","none").style("stroke-dasharray","5"),r.selectAll(".vert_line").data(o).exit().remove(),r.selectAll(".hor_line").data(i).enter().append("line").classed("hor_line",!0),r.selectAll(".hor_line").data(i).attr("x1",this.svgPadding).attr("x2",this.svgWidth-this.svgPadding).attr("y1",(function(t){return e.scaleY(t)})).attr("y2",(function(t){return e.scaleY(t)})).style("stroke-width",1).style("stroke","gray").style("fill","none").style("stroke-dasharray",5),r.selectAll(".hor_line").data(i).exit().remove()}},{key:"drawAxesAndLegend",value:function(){var e=this.svg,t=p.y4O().scale(this.scaleY);(p.Ys("#y_axis").node()?p.Ys("#y_axis"):e.append("g").attr("id","y_axis")).attr("transform","translate(".concat(this.svgPadding,", 0)")).call(t);var n=p.LLu().scale(this.scaleX);(p.Ys("#x_axis").node()?p.Ys("#x_axis"):e.append("g").attr("id","x_axis")).attr("transform","translate(0, ".concat(this.svgHeight-this.svgPadding,")")).call(n);var a=(0,x.wg)().cells(20).scale(this.scaleQualityValue).labelFormat(p.WUZ(".0f")).shapePadding(-5),r=p.Ys("#colorLegend").node()?p.Ys("#colorLegend"):e.append("g").attr("id","colorLegend");r.call(a);var o=this.svgHeight/2,i=document.getElementById("colorLegend").getBBox().height;r.attr("transform","translate(".concat(this.svgWidth-this.svgPadding+5,", ").concat(o-i/2,")"));var l=p.Ys("#plot-header").node()?p.Ys("#plot-header"):e.append("text").attr("id","plot-header").attr("font-weight","bold").attr("font-size","22");l.text("PCB Plot");var s=l.node().getBBox().width,d=l.node().getBBox().height;l.attr("transform","translate(".concat(this.svgWidth/2-s/2,", ").concat(this.svgPadding/2+d/2+5,")"));var c=p.Ys("#x-axis-title").node()?p.Ys("#x-axis-title"):e.append("text").attr("id","x-axis-title");c.text(this.posxCol);var u=c.node().getBBox().width;c.attr("transform","translate(".concat(this.svgWidth/2-u/2,", ").concat(this.svgHeight-this.svgPadding/2,")"));var g=p.Ys("#y-axis-title").node()?p.Ys("#y-axis-title"):e.append("text").attr("id","y-axis-title");g.text(this.posyCol);var h=g.node().getBBox().width;g.attr("transform","translate(".concat(this.svgPadding/2,", ").concat(this.svgHeight/2+h/2,") rotate(-90)"))}},{key:"aggregateQualityInGrid",value:function(e,t,n){var a=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"mean",o=Math.floor(t/gridsize.value),i=Math.floor(n/gridsize.value),l=[o*gridsize.value,(o+1)*gridsize.value],s=[i*gridsize.value,(i+1)*gridsize.value],d=e.filter((function(e){return e[a.posxCol]>=l[0]&&e[a.posxCol]<l[1]&&e[a.posyCol]>=s[0]&&e[a.posyCol]<s[1]}));d=d.map((function(e){return Number(e[a.val_col.value])}));var c,u=0;if("mean"==r){var g=d.reduce((function(e,t){return e+t}),0),h=g/d.length;u=h}return isNaN(u)&&(console.log("NaN in aggregation!"),(c=console).log.apply(c,["In gridcell [%d, %d]; [%d, %d]"].concat(l,s)),console.log(d.reduce((function(e,t){return e+t}),0)),console.log("called for component at (%d, %d)",t,n)),u}}],n&&w(t.prototype,n),a&&w(t,a),e}();function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=z(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw o}}}}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var a,r,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw r}}return o}(e,t)||z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var B,O=document.getElementById("spi_data"),A=document.getElementById("gridsize"),Y=document.getElementById("value-column"),P=document.getElementById("confirm-import"),k=window.sessionStorage;function L(){var e=_(O.files,1)[0];y.read_csv(e,{preview:10,beforeFirstChunk:function(e){return e.replaceAll(/^\s+.*$(?:\r\n?|\n)/gm,"")}}).then((function(e){console.log("Finished loading preview data %O",e),p.Ys("#csv-preview").select("table").select("thead").select("tr").selectAll(".col_header").data(e.$columns).enter().append("th").text((function(e){return e})),p.Ys("#csv-preview").selectAll(".col_header").data(e.$columns).exit().remove(),p.Ys("#csv-preview").select("table").append("tbody").selectAll("tr").data(e.$data).enter().append("tr").selectAll("td").data((function(e){return e})).enter().append("td").text((function(e){return e})),p.Ys("#csv-preview").select("table").selectAll("tr").data(e.$data).exit().remove(),document.getElementById("csv-preview").style.display="flex",document.getElementById("plot-container").style.display="none",function(e){var t,n=document.getElementById("posx-select"),a=E(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,o=document.createElement("option");o.value=r,o.innerHTML=r,n.appendChild(o)}}catch(e){a.e(e)}finally{a.f()}var i=e.map((function(e){return e.toLowerCase()})).findIndex((function(e){return e.match(/\W*pos.*x/)}));n.children[i].selected="selected";var l,s=document.getElementById("posy-select"),d=E(e);try{for(d.s();!(l=d.n()).done;){var c=l.value,u=document.createElement("option");u.value=c,u.innerHTML=c,s.appendChild(u)}}catch(e){d.e(e)}finally{d.f()}var g=e.map((function(e){return e.toLowerCase()})).findIndex((function(e){return e.match(/\W*pos.*y/)}));s.children[g].selected="selected";var h,v=document.getElementById("sizex-select"),f=E(e);try{for(f.s();!(h=f.n()).done;){var m=h.value,p=document.createElement("option");p.value=m,p.innerHTML=m,v.appendChild(p)}}catch(e){f.e(e)}finally{f.f()}var y=e.map((function(e){return e.toLowerCase()})).findIndex((function(e){return e.match(/\W*size.*x/)}));console.log(y),v.children[y].selected="selected";var x,b=document.getElementById("sizey-select"),w=E(e);try{for(w.s();!(x=w.n()).done;){var C=x.value,I=document.createElement("option");I.value=C,I.innerHTML=C,b.appendChild(I)}}catch(e){w.e(e)}finally{w.f()}var _=e.map((function(e){return e.toLowerCase()})).findIndex((function(e){return e.match(/\W*size.*y/)}));b.children[_].selected="selected"}(e.$columns)}))}function j(){var e=_(O.files,1)[0];O.form.reset(),document.getElementById("plot-container").style.display="flex",document.getElementById("csv-preview").style.display="none",console.log("starting to load data from %s",e),y.read_csv(e,{beforeFirstChunk:function(e){return e.split("\n").slice(2).join("\n")}}).then((function(e){console.log("finished loading data %O",e);var t=Y.value?Y.value:"Height(um)",n=document.getElementById("posx-select").value,a=document.getElementById("posy-select").value,r=document.getElementById("sizex-select").value,o=document.getElementById("sizey-select").value,i={barcode:e.Barcode[0],maxQualityValue:e[t].max(),minQualityValue:e[t].min(),maxX:e[n].max()+e[r].max(),minX:e[n].min()-e[r].max(),maxY:e[a].max()+e[o].max(),minY:e[a].min()-e[o].max()};k.setItem("data",JSON.stringify(e)),k.setItem("columns",JSON.stringify(e.columns)),k.setItem("max_values",JSON.stringify(i)),k.setItem("posxCol",n),k.setItem("posyCol",a),k.setItem("sizexCol",r),k.setItem("sizeyCol",o),N(),B.plotData()}))}function N(){var e=JSON.parse(k.getItem("columns"));if(e){var t,n=E(e);try{for(n.s();!(t=n.n()).done;){var a=t.value,r=document.createElement("option");r.value=a,r.innerHTML=a,Y.appendChild(r)}}catch(e){n.e(e)}finally{n.f()}}var o=k.getItem("quality_column");Y.value=o||"Height(um)"}window.onload=function(){N(),B=new I(A,Y),O.addEventListener("input",L),A.addEventListener("change",(function(){B.plotData()})),Y.addEventListener("change",(function(){k.setItem("quality_column",Y.value),B.plotData()})),window.addEventListener("resize",B.plotData),P.addEventListener("click",j)}},71253:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(8081),r=n.n(a),o=n(23645),i=n.n(o)()(r());i.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap);"]),i.push([e.id,'html,body{font-family:"Roboto",sans-serif;background:#f5f6f7}#tooltip{background:#fff8dc;border:1px solid #000;border-radius:5px;padding:5px}td,th{padding:5px}th:hover,td:hover,tr:hover{background-color:#f5f6f7}.container{display:flex;margin:1rem;padding:5px}#svg-container{width:63%;margin-left:auto;margin-right:2rem}#plotoptions{width:20%;margin-right:auto}#plotoptions label{width:40%}#plotoptions input,#plotoptions select{width:auto;margin-left:auto;float:right}#preview-table-container{width:70%;overflow-x:auto}#import-settings-container{width:25%}.card{background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24)}.card:hover{box-shadow:0 14px 28px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.22)}footer{display:flex}',""]);const l=i},50914:()=>{},75410:()=>{},48628:()=>{},55778:()=>{},31601:()=>{},67792:()=>{},34977:()=>{},52007:()=>{},75042:()=>{},55382:()=>{},72095:()=>{},61219:()=>{}},n={};function a(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=t,a.amdD=function(){throw new Error("define cannot be used indirect")},a.amdO={},e=[],a.O=(t,n,r,o)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,r,o]=e[c],l=!0,s=0;s<n.length;s++)(!1&o||i>=o)&&Object.keys(a.O).every((e=>a.O[e](n[s])))?n.splice(s--,1):(l=!1,o<i&&(i=o));if(l){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,r,o]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={894:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[i,l,s]=n,d=0;if(i.some((t=>0!==e[t]))){for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(s)var c=s(a)}for(t&&t(n);d<i.length;d++)o=i[d],a.o(e,o)&&e[o]&&e[o][0](),e[i[d]]=0;return a.O(c)},n=self.webpackChunkbi_js_poc=self.webpackChunkbi_js_poc||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var r=a.O(void 0,[736],(()=>a(43766)));r=a.O(r)})();